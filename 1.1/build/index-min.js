/*!build time : 2013-12-16 1:39:51 PM*/
KISSY.add("gallery/filter/1.1/index",function(a,b){function c(){var a=this;c.superclass.constructor.apply(a,arguments),a._init()}return a.extend(c,b,{_init:function(){var b=this,c=b.get("id");if(!c)throw new Error("\u8bf7\u8bbe\u7f6e\u7b5b\u9009\u6a21\u5757id");if(b.nContainer=a.one(c),!b.nContainer)throw new Error("\u672a\u627e\u5230\u7b5b\u9009\u6a21\u5757\u5bb9\u5668");if(b.nFilterTags=b.nContainer.all(b.get("tagClass")),b.nFilterTags.length<1)throw new Error("\u672a\u627e\u5230\u7b5b\u9009\u9879\uff0c\u8bf7\u68c0\u67e5\u7b5b\u9009\u9879className\u662f\u5426\u914d\u7f6e\u6b63\u786e");b.nFilterUnlimit=b.nContainer.one(b.get("unlimitClass")),b._radioText=null,b._radioValue=null,b._checkboxText=[],b._checkboxValue=[],b._bindUI(),b.afterInit()},afterInit:function(){},select:function(a){var b=this;switch(b.get("type")){case"radio":b._radioSelect(a);break;case"checkbox":b._checkboxSelect(a)}},remove:function(a){var b=this;switch(b.get("type")){case"radio":b._radioRemove();break;case"checkbox":b._checkboxRemove(a)}},getValue:function(){var b=this;switch(b.get("type")){case"radio":return{text:b._radioText,value:b._radioValue};case"checkbox":return{text:a.clone(b._checkboxText),value:a.clone(b._checkboxValue)}}},getLength:function(){var a=this;switch(a.get("type")){case"radio":return a._radioValue?1:0;case"checkbox":return a._checkboxValue.length}},disabled:function(b){var c=this,d=c.get("disabledClass");return a.isArray(b)&&b.length>0?(c.nFilterTags.each(function(c){a.inArray(c.attr("data-value"),b)&&c.addClass(d)}),void 0):(c.nFilterTags.addClass(d),c.nFilterUnlimit&&c.nFilterUnlimit.removeClass(d),void 0)},enabled:function(b){var c=this,d=c.get("disabledClass");return a.isArray(b)&&b.length>0?(c.nFilterTags.each(function(c){a.inArray(c.attr("data-value"),b)&&c.removeClass(d)}),void 0):(c.nFilterTags.removeClass(d),void 0)},_bindUI:function(){var b=this;b.nContainer.delegate("click",b.get("tagClass"),function(c){c.preventDefault();var d=a.one(c.currentTarget),e=d.attr("data-value"),f=d.hasClass(b.get("unlimitClass").substr(1)),g=d.hasClass(b.get("selectedClass").substr(1)),h=d.hasClass(b.get("disabledClass").substr(1));if(!h){switch(b.get("type")){case"radio":switch(!0){case g:return;default:b.select(e)}break;case"checkbox":switch(!0){case f&&g:return;case g:b.remove(e);break;default:b.select(e)}}b.fire("select",{option:b.getValue()})}})},_radioSelect:function(a){var b=this,c=b.get("selectedClass"),d=b.nContainer.one('a[data-value="'+a+'"]')||b.nFilterUnlimit;b.nFilterTags.removeClass(c),d&&d.addClass(c),b._radioText=d&&d.attr("data-text"),b._radioValue=a},_radioRemove:function(){var a=this;a._radioSelect()},_checkboxSelect:function(b){var c=this,d=c.get("selectedClass");return b?(c.nFilterUnlimit&&c.nFilterUnlimit.removeClass(d),a.each(b.split(","),function(a){var b=c.nContainer.one('a[data-value="'+a+'"]');b&&(b.addClass(d),c._checkboxText.push(b.attr("data-text")),c._checkboxValue.push(b.attr("data-value")))}),void 0):(c._checkboxText.length=0,c._checkboxValue.length=0,c.nFilterTags.removeClass(d),c.nFilterUnlimit&&c.nFilterUnlimit.addClass(d),void 0)},_checkboxRemove:function(b){var c=this,d=c.nContainer.one('a[data-value="'+b+'"]'),e=a.indexOf(b,c._checkboxValue),f=c.get("selectedClass");return b?(d&&d.removeClass(f),-1!=e&&(c._checkboxText.splice(e,1),c._checkboxValue.splice(e,1)),c._checkboxValue.length<1&&c._checkboxSelect(),void 0):(c._checkboxSelect(),void 0)}},{ATTRS:{id:{value:"",getter:function(a){return/^#.+/.test(a)?a:"#"+a}},type:{value:"radio"},tagClass:{value:"filter-tag",getter:function(a){return/^\..+/.test(a)?a:"."+a}},unlimitClass:{value:"filter-unlimit",getter:function(a){return/^\..+/.test(a)?a:"."+a}},selectedClass:{value:"selected",getter:function(a){return/^\..+/.test(a)?a:"."+a}},disabledClass:{value:"disabled",getter:function(a){return/^\..+/.test(a)?a:"."+a}}}})},{requires:["base","node"]});